# EKS on Outposts Example

Configuration in this directory creates an Amazon EKS local cluster on AWS Outposts

See the [AWS documentation](https://docs.aws.amazon.com/eks/latest/userguide/eks-outposts.html) for further details.

Note: This example requires an an AWS Outpost to provision.

## Usage

To run this example you need to:

1. Deploy the remote host where the cluster will be provisioned from. The remote host is required since only private access is permitted to clusters created on Outposts. If you have access to the network where Outposts are provisioned (VPN, etc.), you can skip this step:

```bash
$ cd prerequisites
$ terraform init
$ terraform plan
$ terraform apply --auto-approve
```

2. If provisioning using the remote host deployed in step 1, connect to the remote host using SSM. Note, you will need to have the [SSM plugin for the AWS CLI installed](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html). You can use the output generated by step 1 to connect:

```bash
$ aws ssm start-session --region <REGION> --target <INSTANCE_ID>
```

3. Once connected to the remote host, navigate to the cloned project example directory and deploy the example:

```bash
$ cd $HOME/terraform-aws-eks/examples/outposts
$ terraform init
$ terraform plan
$ terraform apply --auto-approve
```

Note that this example will create resources that cost money. Run `terraform destroy` when you don't need these resources.

```bash
terraform destroy --auto-approve
```
